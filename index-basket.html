<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basket</title>
    <link rel="stylesheet" href="stylesheets/style.css">
    <link rel="stylesheet" media="screen and (max-width: 1024px)" href="stylesheets/style1024px.css">
    <link rel="stylesheet" media="screen and (max-width: 480px)" href="stylesheets/style480px.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>
    <!-- ОБОЛОЧКА САЙТА-->
    <div class="container">

        <!-- ШАПКА САЙТА-->
        <header>
          <a href="index.html">
            <div class="header_logo">
              <img src="img/logo_top100px.svg" alt="logo">
              <h1 class="TechGrove">
                <span class="T">T</span>ech<span class="G">G</span>rove
              </h1>
            </div>
          </a>
    
          <!-- НАВИГАЦИЯ В БЛОКЕ-->
          <div class="header_nav">
            <nav>
              <ul>
                <a href="index.html"><li>Главная</li></a>
                <a href="index-payment.html"><li>оплата</li></a>
                <a href="index-delivery.html"><li>доставка</li></a>
                <a href="index-about-us.html"><li>О нас</li></a>
                <a href="index-basket.html"><li>Корзина</li><img class="header_basket" src="img/svg_image.png" alt="Корзина"></a>
              </ul>
            </nav>
          </div>
          <div class="burger-menu">
            <input type="checkbox" id="burgerToggle">
            <label for="burgerToggle">
              <span class="line"></span>
              <span class="line"></span>
              <span class="line"></span>
            </label>
            <ul>
              <li><a href="index.html">Главная</a></li>
              <li><a href="index-payment.html">Оплата</a></li>
              <li><a href="index-delivery.html">Доставка</a></li>
              <li><a href="index-about-us.html">О нас</a></li>
              <li><a href="index-basket.html">Корзина <img class="header_basket" src="img/svg_image.png" alt="Корзина"></a></li>
              <li class="has-submenu">
                <input type="checkbox" id="catalogToggleCheckbox">
                <label for="catalogToggleCheckbox" class="catalog-menu-toggle-label">
                  <span class="line"></span>
                  <span class="line"></span>
                  <span class="line"></span>Каталог</label>
                <ul class="catalog-menu">
                  <li><a href="index-refrigerators.html">Холодильники</a></li>
                  <li><a href="index-vacuums.html">Пылесосы</a></li>
                  <li><a href="index-washing-machines.html">Стиральные машины</a></li>
                  <li><a href="index-microwaves.html">Микроволновки</a></li>
                  <li><a href="index-dishwashers.html">Посудомоечные машины</a></li>
                  <li><a href="index-coffeemaker.html">Кофемашины</a></li>
                  <li><a href="index-cooker-hoods.html">Вытяжки кухонные</a></li>
                  <li><a href="index-baths.html">Ванны</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </header>
  
        <!-- ОБОЛОЧКА ОСНОВНОЙ ИНФОРМАЦИИ САЙТА-->
        <div class="content">
  
          <!-- БЛОК ОСНОВНОЙ ИНФОРМАЦИИ САЙТА-->
          <main>
            <h1 class="busket__title">Корзина</h1>
            <div class="catalog" id="basket"></div>
            <div id="total" style="display: none;"></div>
            <div class="busket__buttons product__buttons">
              <button onclick="clearCart()" id="clearButton" style="display: none;">Очистить корзину</button>
              <button onclick="openModal()" id="placeOrder">Оформить заказ</button>  
            </div>
            
            <div id="modal" class="modal">
              <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <h2>Оформление заказа</h2>
                <form id="checkoutForm">
                  <label for="name">Имя:</label>
                  <input type="text" id="name" name="name" required>
                  <label for="surname">Фамилия:</label>
                  <input type="text" id="surname" name="surname" required>
                  <label for="telephone">Телефон:</label>
                  <input type="tel" maxlength="13" id="telephone" name="telephone" required>
                  <label for="address">Адрес доставки:</label>
                  <textarea id="address" name="address" rows="4" cols="50" required></textarea>
                  <label for="comment">Комментарий к заказу:</label>
                  <textarea id="comment" name="comment" rows="4" cols="50"></textarea>
                  <div class="product__buttons">
                    <button type="button" onclick="handleSubmit()">Оформить заказ</button>
                  </div>
                </form>
              </div>
            </div>
            
            <div id="orderProcessedModal" class="modal">
              <div class="modal-content">
                <span class="close" onclick="closeOrderProcessedModal()">&times;</span>
                <h2>Ваш заказ обработан</h2>
                <p>Ожидайте, наш специалист свяжется с вами в ближайшее время.</p>
              </div>
            </div>
            
            <div id="alertModal" class="modal">
              <div class="modal-content alert">
                <span class="close" onclick="closeAlertModal()">&times;</span>
                <p id="alertMessage">Пожалуйста, заполните все обязательные поля.</p>
              </div>
            </div>
            <p id="emptyCartMessage" style="display: none;">Здесь пока нету ваших заказов</p>
            <p id="returnToMain"><a href="index.html">Вернуться на Главную</a></p>
        </main>
  
        </div>
        <!-- ПОДВАЛ САЙТА -->
        <footer>
          <a href="index.html"><p class="TechGrove">
            <span class="T">T</span>ech<span class="G">G</span>rove
          </p></a>
          <div class="feedback">
            <div class="feedback--item1">Обратная связь</div>
            <div class="feedback--item">Instagram</div>
            <div class="feedback--item"><a href="https://www.instagram.com/vonsik_stanislav?igsh=MWZ6YmwyNHpyZ29sZQ==">vonsik_stanislav</a></div>
            <div class="feedback--item">VKontakte</div>
            <div class="feedback--item"><a href="https://vk.com/vonsik_stanislav">vonsik_stanislav</a></div>
            <div class="feedback--item6"> <a href="https://discord.com/invite/sdK98pgp"> Наш discord!</div>
          </div>
          <div class="footer__left__info">
            <div class="footer__info">
              <a href="index-about-us.html"><p class="footer__info__text">о нас</p></a>
              <a href="index-delivery.html"><p class="footer__info__text">доставка</p></a>
              <a href="index-payment.html"><p class="footer__info__text">оплата</p></a>
            </div>
            
          </div>
          <a class="button__to__top go--top"  id="button__to__top">
            <img src="img/button_to_top.png" alt="">  
          </a>
        </footer>
      </div>
      <script src="js/script.js"></script>
    <script>
   document.addEventListener("DOMContentLoaded", function() {
            displayCart();
        });

        function displayCart() {
            // Получаем данные о корзине из localStorage
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            // Очищаем содержимое корзины перед обновлением
            document.getElementById('basket').innerHTML = '';

            // Создаем карточки товаров в корзине
            cart.forEach(item => {
                const productDiv = document.createElement('div');
                productDiv.classList.add('product'); // Добавляем класс 'product' для стилизации

                // Получаем информацию о товаре из XML по его названию
                fetch('../xml/catalog.xml')
                    .then(response => response.text())
                    .then(xmlString => {
                        const parser = new DOMParser();
                        const xmlDoc = parser.parseFromString(xmlString, 'text/xml');
                        
                        // Находим товар по его названию
                        const products = xmlDoc.getElementsByTagName('product');
                        for (let i = 0; i < products.length; i++) {
                            const product = products[i];
                            const productName = product.getElementsByTagName('name')[0].textContent;

                            if (productName === item.name) {
                               // Получаем тип товара
                                const type = product.getAttribute('type');

                                // Проверяем, что это холодильник
                                if (type === 'холодильники') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
                                const width = product.getElementsByTagName('width')[0].textContent;
                                const length = product.getElementsByTagName('length')[0].textContent;
                                const NoFrost = product.getElementsByTagName('NoFrost')[0].textContent;
                                const height = product.getElementsByTagName('height')[0].textContent;
                                const color = product.getElementsByTagName('color')[0].textContent;
                                const freshnessZone = product.getElementsByTagName('FreshnessZone')[0].textContent;
                                const image = product.getElementsByTagName('image')[0].textContent;

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                                        <li><span class="product__span">Вес:</span> ${weight}</li>
                                        <li><span class="product__span">Ширина:</span> ${width}</li>
                                        <li><span class="product__span">Длина:</span> ${length}</li>
                                        <li><span class="product__span">Высота:</span> ${height}</li>
                                        <li><span class="product__span">No Frost:</span> ${NoFrost}</li>
                                        <li><span class="product__span">Цвет:</span> ${color}</li>
                                        <li><span class="product__span">Зона свежести:</span> ${freshnessZone}</li>
                                    </ul>
                                    <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;} 
                                if (type === 'пылесосы') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
                                const vacuumCleanerType = product.getElementsByTagName('vacuumCleanerType')[0].textContent;
                                const cleaningType = product.getElementsByTagName('cleaningType')[0].textContent;
                                const power = product.getElementsByTagName('power')[0].textContent;
                                const dustCollectorType = product.getElementsByTagName('dustCollectorType')[0].textContent;
                                const color = product.getElementsByTagName('color')[0].textContent;
                                const dustCollectorCapacity = product.getElementsByTagName('dustCollectorCapacity')[0].textContent;
                                const image = product.getElementsByTagName('image')[0].textContent;
                                                
                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                                <li><span class="product__span">Вес: </span>${weight}</li>
                                <li><span class="product__span">Тип пылесоса: </span>${vacuumCleanerType}</li>
                                <li><span class="product__span">Тип уборки: </span>${cleaningType}</li>
                                <li><span class="product__span">Тип пылесборщика</span>${dustCollectorType}</li>
                                <li><span class="product__span">Мощность</span>${power}</li>
                                <li><span class="product__span">Цвет: </span>${color}</li>
                                <li><span class="product__span">Объем пылесборщика: }</span>${dustCollectorCapacity}</li>
                            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'кофемашины') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
    const width = product.getElementsByTagName('width')[0].textContent;
    const length = product.getElementsByTagName('length')[0].textContent;
    const TypeOfCoffeeUsed = product.getElementsByTagName('TypeOfCoffeeUsed')[0].textContent;
    const height = product.getElementsByTagName('height')[0].textContent;
    const color = product.getElementsByTagName('color')[0].textContent;
    const power = product.getElementsByTagName('power')[0].textContent;
    const image = product.getElementsByTagName('image')[0].textContent;
                                                
                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                <li><span class="product__span">Вес: </span>${weight}</li>
                <li><span class="product__span">Ширина: </span>${width}</li>
                <li><span class="product__span">Длина: </span>${length}</li>
                <li><span class="product__span">Высота: </span>${height}</li>
                <li><span class="product__span">Тип используемого кофе:</span>${TypeOfCoffeeUsed}</li>
                <li><span class="product__span">Цвет: </span>${color}</li>
                <li><span class="product__span">Мощность: </span>${power}</li>
            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'стиральные машины') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
                    const width = product.getElementsByTagName('width')[0].textContent;
                    const length = product.getElementsByTagName('length')[0].textContent;
                    const motorType = product.getElementsByTagName('motorType')[0].textContent;
                    const height = product.getElementsByTagName('height')[0].textContent;
                    const color = product.getElementsByTagName('color')[0].textContent;
                    const laundryLoadWeight = product.getElementsByTagName('laundryLoadWeight')[0].textContent;
                    const image = product.getElementsByTagName('image')[0].textContent;

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                  <ul>
                                <li><span class="product__span">Вес: </span>${weight}</li>
                                <li><span class="product__span">Ширина: </span>${width}</li>
                                <li><span class="product__span>Длина: </span>${length}</li>
                                <li><span class="product__span">Высота: </span>${height}</li>
                                <li><span class="product__span">Тип мотора: </span>${motorType}</li>
                                <li><span class="product__span">Цвет: </span>${color}</li>
                                <li><span class="product__span">Вес зазагрузки белья: </span>${laundryLoadWeight}</li>
                            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'микроволновые печи') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
                    const width = product.getElementsByTagName('width')[0].textContent;
                    const length = product.getElementsByTagName('length')[0].textContent;
                    const power = product.getElementsByTagName('power')[0].textContent;
                    const height = product.getElementsByTagName('height')[0].textContent;
                    const color = product.getElementsByTagName('color')[0].textContent;
                    const grill = product.getElementsByTagName('grill')[0].textContent;
                    const image = product.getElementsByTagName('image')[0].textContent;

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                                <li><span class="product__span">Вес: </span>${weight}</li>
                                <li><span class="product__span">Ширина: </span>${width}</li>
                                <li><span class="product__span">Длина: </span>${length}</li>
                                <li><span class="product__span">Высота: </span>${height}</li>
                                <li><span class="product__span">Мощность: </span>${power}</li>
                                <li><span class="product__span">Цвет: </span>${color}</li>
                                <li><span class="product__span">Гриль: </span>${grill}</li>
                            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'ванны') {
                                // Получаем остальные характеристики товара из XML
                                const literage = product.getElementsByTagName('literage')[0].textContent;
                    const width = product.getElementsByTagName('width')[0].textContent;
                    const length = product.getElementsByTagName('length')[0].textContent;
                    const height = product.getElementsByTagName('height')[0].textContent;
                    const color = product.getElementsByTagName('color')[0].textContent;
                    const type = product.getElementsByTagName('type')[0].textContent;
                    const image = product.getElementsByTagName('image')[0].textContent;

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                                <li><span class="product__span">Объем: </span>${literage}</li>
                                <li><span class="product__span">Ширина: </span>${width}</li>
                                <li><span class="product__span">Длина: </span>${length}</li>
                                <li><span class="product__span">Высота: </span>${height}</li>
                                <li><span class="product__span">Тип </span>${type}</li>
                                <li><span class="product__span">Цвет: </span>${color}</li>
                            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'кухонные вытяжки') {
                                // Получаем остальные характеристики товара из XML
                const weight = product.getElementsByTagName('weight')[0]?.textContent || '';
                const width = product.getElementsByTagName('width')[0]?.textContent || '';
                const length = product.getElementsByTagName('length')[0]?.textContent || '';
                const height = product.getElementsByTagName('height')[0]?.textContent || '';
                const color = product.getElementsByTagName('color')[0]?.textContent || '';
                const image = product.getElementsByTagName('image')[0]?.textContent || '';
                const power = product.getElementsByTagName('power')[0]?.textContent || '';

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                  <ul>
                                <li><span class="product__span">Вес: </span>${weight}</li>
                                <li><span class="product__span">Ширина: </span>${width}</li>
                                <li><span class="product__span>Длина: </span>${length}</li>
                                <li><span class="product__span">Высота: </span>${height}</li>
                                <li><span class="product__span">Цвет: </span>${color}</li>
                                <li><span class="product__span">Мощность: </span>${power}</li>
                            </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                                if (type === 'посудомоечные машины') {
                                // Получаем остальные характеристики товара из XML
                                const weight = product.getElementsByTagName('weight')[0].textContent;
                const width = product.getElementsByTagName('width')[0].textContent;
                const length = product.getElementsByTagName('length')[0].textContent;
                const height = product.getElementsByTagName('height')[0].textContent;
                const color = product.getElementsByTagName('color')[0].textContent;
                const image = product.getElementsByTagName('image')[0].textContent;
                const numberOfPlaceSettings = product.getElementsByTagName('numberOfPlaceSettings')[0].textContent;
                const energyEfficiencyClass = product.getElementsByTagName('energyEfficiencyClass')[0].textContent;

                                // Формируем HTML для карточки товара в корзине с характеристиками
                                productDiv.innerHTML = `
                                    <img class="product__img" src="${image}" alt="${item.name}">
                                    <h2>${item.name}</h2>
                                    <ul>
                            <li><span class="product__span">Вес:</span>${weight}</li>
                            <li><span class="product__span>Ширина: </span>${width}</li>
                            <li><span class="product__span">Длина: </span>${length}</li>
                            <li><span class="product__span">Высота: </span>${height}</li>
                            <li><span class="product__span">Цвет: <span>${color}</li>
                            <li><span class="product__span">Класс энергопотребления</span>${energyEfficiencyClass}</li>
                            <li><span class="product__span">Количество рассадочных приборов: </span>${numberOfPlaceSettings}</li>
                        </ul>
                            <p>${item.price}</p>
                                    <p>Количество: ${item.quantity}</p>
                                    <div class="product__buttons">
                                        <button onclick="increaseQuantity('${item.name}', event)">+</button>
                                        <button onclick="removeFromCart('${item.name}')" class="delete">Удалить</button>
                                        <button onclick="decreaseQuantity('${item.name}', event)">-</button>
                                    </div>
                                `;
                                }
                            }
                        }
                    })
                    .catch(error => console.error('Error fetching XML:', error));

                document.getElementById('basket').appendChild(productDiv);
            });

            // Показываем общую сумму заказа
            const totalPrice = cart.reduce((total, item) => total + parseFloat(item.price) * item.quantity, 0);
            document.getElementById('total').innerHTML = `<p>Итого:<span class="bold"> ${totalPrice.toFixed(2)} бел.руб</span></p>`;

            // Скрываем/показываем нужные элементы в зависимости от состояния корзины
            if (cart.length === 0) {
              
              document.getElementById('checkoutForm').style.display = 'none';
                document.getElementById('total').style.display = 'none';
                document.getElementById('clearButton').style.display = 'none';
                document.getElementById('placeOrder').style.display = 'none';
                document.getElementById('emptyCartMessage').style.display = 'block';
                document.getElementById('returnToMain').style.display = 'block';
            } else {
              document.getElementById('checkoutForm').style.display = 'block';
                document.getElementById('total').style.display = 'block';
                document.getElementById('clearButton').style.display = 'block';
                document.getElementById('placeOrder').style.display = 'block';
                document.getElementById('emptyCartMessage').style.display = 'none';
                document.getElementById('returnToMain').style.display = 'none';
            }
            //            <button onclick="openModal()" id="placeOrder">Оформить заказ</button>

        }

function removeFromCart(name) {
    // Получаем данные о корзине из localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // Удаляем товар из корзины по имени
    cart = cart.filter(item => item.name !== name);

    // Обновляем данные о корзине в localStorage
    localStorage.setItem('cart', JSON.stringify(cart));

    // Обновляем отображение корзины
    displayCart();
}

function clearCart() {
    // Очищаем localStorage
    localStorage.removeItem('cart');

    // Обновляем отображение корзины
    displayCart();
}

function increaseQuantity(name) {
    // Получаем данные о корзине из localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // Увеличиваем количество выбранного товара
    cart.forEach(item => {
        if (item.name === name) {
            item.quantity += 1;
        }
    });

    // Обновляем данные о корзине в localStorage
    localStorage.setItem('cart', JSON.stringify(cart));

    // Обновляем отображение корзины
    displayCart();
}

function decreaseQuantity(name) {
    // Получаем данные о корзине из localStorage
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // Уменьшаем количество выбранного товара
    cart.forEach(item => {
        if (item.name === name) {
            if (item.quantity > 1) {
                item.quantity -= 1;
            } else {
                // Если количество товара становится меньше или равно 1, удаляем его из корзины
                cart = cart.filter(cartItem => cartItem.name !== name);
            }
        }
    });

    // Обновляем данные о корзине в localStorage
    localStorage.setItem('cart', JSON.stringify(cart));

    // Обновляем отображение корзины
    displayCart();
}
</script>
</body>
</html>
